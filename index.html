<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame
		Remove this if you use the .htaccess -->
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<title>index</title>
		<meta name="description" content="" />
		<meta name="generator" content="Studio 3 http://aptana.com/" />
		<meta name="author" content="Admissions" />
		<meta name="viewport" content="width=device-width; initial-scale=1.0" />
		<!-- Replace favicon.ico & apple-touch-icon.png in the root of your domain and delete these references -->
		<link rel="shortcut icon" href="/favicon.ico" />
		<link rel="apple-touch-icon" href="/apple-touch-icon.png" />
		<link rel="stylesheet" type="text/css" href="css/style.css" media="all" />
	</head>
	<body>
		<div>
			<header>
				<h1>Ferris Application</h1>
			</header>
			<div>
				<form action="" method="" id="newResumeForm">

				</form>
			</div>
		</div>
	</body>
</html>

<script id="section-template" type="text/x-handlebars-template" title="formSection">
	<fieldset id="{{id}}" class="resume-form-section">
		<legend>{{title}}</legend>
		{{#if showFields}}
		<ul id="{{#if refValue}}{{refValue}}{{/if}}">
			{{#each fields}}
			<li>
				{{{this}}}
			</li>
			{{/each}}
		</ul>
		{{/if}}
		{{#if replicate}}
		<p class="addFormArea">
			<a class="addFormArea">Add another {{title_singular}}</a>
		</p>
		{{/if}}
	</fieldset>
</script>

<script id="form-radiolist-template" type="text/x-handlebars-template" title="formRadioList">
	<h3>{{title}}</h3>
	{{#each elements}}
		<p><label>{{this.label}}</label><input type="radio" name="{{name}}" value="{{this.value}}" /></p>
	{{/each}}
</script>

<script type="text/javascript" src="mustache.js">//</script>
<script type="text/javascript" src="underscore.js">//</script>
<script type="text/javascript" src="jquery-1.5.1.min.js">//</script>
<script type="text/javascript">

formValues = {
    pages: {
    	"Personal_Information" : {
	        title: "Personal Information",
	        sections: {
	            "Student_Type": {
	                title: "Student Type - Check Only One",
	                fields: {
	                    "stdnt_type": {
	                        type: "formRadioList",
	                        elements: [ {label:"Associate Degree Student", value:"assoc", name:"stdnt_type"}, {label:"Bachelor Degree Student", value:"bach", name:"stdnt_type"}, {label:"Certificate Student", value:"cert", name:"stdnt_type"}, {label:"Non-degree Student", value:"nondeg", name:"stdnt_type"}, {label:"High School Student", value:"highsch", name:"stdnt_type"}, {label:"Guest Student", value:"guest", name:"stdnt_type"}, {label:"Apprenticeship Program",value:"apprent", name:"stdnt_type"}, {label:"Continuing Education Units (CEU)",value:"ceu", name:"stdnt_type"}],
	                        length: 7,
	                        required: true,
	                        error: "string",
	                        show: true
	                    }
	                }
	            },
	            "Student_Status": {
	                title: "Student Status - Check all that apply",
	                fields: {
	                    "stts_frmer": {
	                    	name: "stdnt_type",
	                        type: "checkbox",
	                        label: "Former Student",
	                        value: "",
	                        length: 1,
	                        required: true,
	                        error: "string",
	                        show: true
	                    },
	                    "stts_othCllge": {
	                        type: "checkbox",
	                        label: "Attended another college",
	                        value: "",
	                        length: 1,
	                        required: true,
	                        error: "string",
	                        show: true
	                    },
	                    "stts_frstCllge": {
	                        type: "checkbox",
	                        label: "First time in any college",
	                        value: "",
	                        length: 1,
	                        required: true,
	                        error: "string",
	                        show: true
	                    },
	                    "stts_inatStdnt": {
	                        type: "checkbox",
	                        label: "International student",
	                        value: "",
	                        length: 1,
	                        required: true,
	                        error: "string",
	                        show: true
	                    },
	                    "stts_permAln": {
	                        type: "checkbox",
	                        label: "A permanent resident alien",
	                        value: "",
	                        length: 1,
	                        required: true,
	                        error: "string",
	                        show: true
	                    }
	                }
	            },
	            "Identification": {
	                title: "Identification",
	                fields: {
	                    "smc_id": {
	                        type: "text",
	                        label: "SMC Student ID",
	                        name: "smc_id",
	                        value: "",
	                        length: 32,
	                        required: true,
	                        error: "string",
	                        show: true
	                    },
	                    "birthdate": {
	                        type: "text",
	                        label: "Birth Date",
	                        name: "birthdate",
	                        value: "",
	                        length: 10,
	                        required: true,
	                        error: "string",
	                        show: true
	                    }
	                }
	            }
	        }
	    }
    }
};

Page = function ( params, templateFactory ){
	this.addSection = function (section, title){
		this.sections[title] = new Section(section);
	}
	
	this.render = function (){
		return( this.template.render(this) );
	}
	
	this.getTemplate = function(){
		this.template = templateFactory.getTemplate(this.type)
	}
	
	this.title = params.title;
	this.type = "formPageTemplate";
	this.sections = {};
	
	_.extend(this, params);
	
	for(section in params.Sections){
		this.addSection(params.Sections[section], section)
	}
	
	this.templateFactory = templateFactory;
	this.getTemplate();
}

Section = function (params, templateFactory){
	this.addField = function (params){
		
	}
	
	this.render = function (){
		
	}
	
	this.title = params.title;
	this.template = "";
	this.fields = {};
	
	for(field in params.fields){
		this.addField(field)
	}
}

Field = function ( params , templateFactory){
	this.render = function (){
		return( this.template.render(this) );
	}
	
	this.setValue = function ( value ){
		
	}
	
	this.getTemplate = function(){
		this.template = templateFactory.getTemplate(this.type)
	}
	
	this.type = "text";
    this.required = false;
    this.error = "This field has an error.";
    this.show = true;
	
	_.extend(this, params);
	
	this.templateFactory = templateFactory;
	this.getTemplate();
}

TemplateFactory = function(TemplateConstructor){
	this.getTemplate = function(type){
		return (this.templates[type]);
	}
	
	templates = new Object();
	
	$('script[type="text/x-handlebars-template"]').each(function(index){
		var datatype = $(this).attr('title');
		var html = $(this).html();
		templates[datatype] = new TemplateConstructor(html);
	})
	
	this.templates = templates;
}

Template = function ( source ) {
	this.source = source;
	this.template = Handlebars.compile(source);
	
	this.render = function (context) {
	    return ( this.template(context) );
	}
}

templateFactory = new TemplateFactory(Template);

stdntTypeField = new Field(formValues.pages.Personal_Information.sections.Student_Type.fields.stdnt_type, templateFactory);

$("body").append(stdntTypeField.render());

templatePrepend = function(html){
	this.append(html);
}

templateRender = function(template, context){
    var source   = $("#"+template).html();
    var template = Handlebars.compile(source);
    return ( template(context) );
}
</script>