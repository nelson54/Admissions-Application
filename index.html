<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame
		Remove this if you use the .htaccess -->
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<title>index</title>
		<meta name="description" content="" />
		<meta name="generator" content="Studio 3 http://aptana.com/" />
		<meta name="author" content="Admissions" />
		<meta name="viewport" content="width=device-width; initial-scale=1.0" />
		<!-- Replace favicon.ico & apple-touch-icon.png in the root of your domain and delete these references -->
		<link rel="shortcut icon" href="/favicon.ico" />
		<link rel="apple-touch-icon" href="/apple-touch-icon.png" />
		<link rel="stylesheet" type="text/css" href="css/style.css" media="all" />
	</head>
	<body>
		
	</body>
</html>

<script id="page-template" type="text/x-handlebars-template" title="formPage">
	<div>
		<header>
			<h1>{{title}}</h1>
		</header>
		<div>
			<form action="" method="" id="newResumeForm">
				{{#each sectionsHtml}}
					{{{this}}}
				{{/each}}
			</form>
		</div>
	</div>
</script>

<script id="form-radiolist-template" type="text/x-handlebars-template" title="navigation">

</script>

<script id="section-template" type="text/x-handlebars-template" title="formSection">
	<h3>{{title}}</h3>
	{{#if subheader}}<p><em>{{subheader}}</em></p>{{/if}}
		<ul>
			{{#each fieldsHtml}}
			<li>
				{{{this}}}
			</li>
			{{/each}}
		</ul>
</script>

<script id="form-radiolist-template" type="text/x-handlebars-template" title="formRadioList">
	<label for="{{name}}"></label>
	{{#each elements}}
		<p><label for="{{name}}">{{this.label}}</label><input type="radio" name="{{name}}" value="{{this.value}}" /></p>
	{{/each}}
</script>

<script id="form-checkboxlist-template" type="text/x-handlebars-template" title="formCheckboxList">
	<label for="{{this.name}}">{{this.label}}</label><br />
	{{#each elements}}
		<input type="checkbox" name="{{this.name}}" value="{{this.value}}" /><label for="{{this.name}}">{{this.label}}</label>
	{{/each}}
</script>

<script id="form-option-template" type="text/x-handlebars-template" title="formOption">
	<p><label for="{{name}}">{{this.label}}</label><br />
	<select name="{{name}}">
	{{#each options}}
		<option value="{{this.value}}">{{this.title}}</option>
	{{/each}}</p>
	</select>
</script>

<script id="form-checkbox-template" type="text/x-handlebars-template" title="formCheckbox">
		<p><label>{{this.label}}</label><input type="checkbox" name="{{name}}" value="{{this.value}}" /></p>
</script>

<script id="form-dateRange-template" type="text/x-handlebars-template" title="formDateRange">
		<p>
			<label>{{this.label}}</label><br />
			<label class="secondry" for="{{fromName}}">From</label>
			<input type="text" class="date" name="{{fromName}}" value="{{this.fromValue}}" />
			<label class="secondry" for="{{toName}}">To</label>
			<input type="text" class="date" name="{{toName}}" value="{{this.toValue}}" /><label class="format">yyyy-mm-dd</label>
		</p>
</script>

<script id="form-dateRange-template" type="text/x-handlebars-template" title="formLocation">
		<p>
			<label>{{this.label}}</label><br />
			<input type="text" class="date" name="{{fromName}}" value="{{this.fromValue}}" />, 
			<select></select>
		</p>
</script>

<script id="form-date-template" type="text/x-handlebars-template" title="formDate">
		<p>
			<label>{{this.label}}</label>
			<input type="text" class="date" name="{{name}}" value="{{this.Value}}" />
			<label class="format">yyyy-mm-dd</label>
		</p>
</script>

<script id="form-boolean-template" type="text/x-handlebars-template" title="formBoolean">
		<p><label>{{this.label}}</label><br />
		<input type="radio" value="1" name="{{name}}" /><label>Yes</label>
		<input type="radio" value="0" name="{{name}}" /><label>No</label>
</script>

<script id="form-phone-template" type="text/x-handlebars-template" title="formPhone">
		<p><label>{{this.label}}</label><br />
		(<input name="{{name}}-phone-1" type="text" maxlength="3"  size="2"  />)<input name="{{name}}-phone-2" type="text" maxlength="3"  size="2"  />-<input name="{{name}}-phone-3" type="text" maxlength="4"  size="3"  /></p>
</script>

<script id="form-text-template" type="text/x-handlebars-template" title="formText">
		<p><label>{{this.label}}</label><input type="text" name="{{name}}" value="{{this.value}}" /></p>
</script>

<script type="text/javascript" src="mustache.js">//</script>
<script type="text/javascript" src="underscore.js">//</script>
<script type="text/javascript" src="jquery-1.5.1.min.js">//</script>
<script type="text/javascript">

formValues = {
    pages: {
    	"Personal_Information" : {
	        title: "Personal Information",
	        sections: {
	            "Student_Type": {
	                title: "Student Type - Check Only One",
	                fields: {
	                    "stdnt_type": {
	                    	name:"stdnt_type",
	                        type: "formRadioList",
	                        elements: [ {label:"Associate Degree Student", value:"assoc", name:"stdnt_type"}, {label:"Bachelor Degree Student", value:"bach", name:"stdnt_type"}, {label:"Certificate Student", value:"cert", name:"stdnt_type"}, {label:"Non-degree Student", value:"nondeg", name:"stdnt_type"}, {label:"High School Student", value:"highsch", name:"stdnt_type"}, {label:"Guest Student", value:"guest", name:"stdnt_type"}, {label:"Apprenticeship Program",value:"apprent", name:"stdnt_type"}, {label:"Continuing Education Units (CEU)",value:"ceu", name:"stdnt_type"}],
	                        length: 7,
	                        required: true,
	                        error: "string",
	                        show: true
	                    }
	                }
	            },
	            "Student_Status": {
	                title: "Student Status - Check all that apply",
	                fields: {
	                    "stts_frmer": {
	                    	name: "stdnt_type",
	                        type: "formCheckbox",
	                        label: "Former Student",
	                        value: "",
	                        length: 1,
	                        required: true,
	                        error: "string",
	                        show: true
	                    },
	                    "stts_othCllge": {
	                        type: "formCheckbox",
	                        label: "Attended another college",
	                        value: "",
	                        length: 1,
	                        required: true,
	                        error: "string",
	                        show: true
	                    },
	                    "stts_frstCllge": {
	                        type: "formCheckbox",
	                        label: "First time in any college",
	                        value: "",
	                        length: 1,
	                        required: true,
	                        error: "string",
	                        show: true
	                    },
	                    "stts_inatStdnt": {
	                        type: "formCheckbox",
	                        label: "International student",
	                        value: "",
	                        length: 1,
	                        required: true,
	                        error: "string",
	                        show: true
	                    },
	                    "stts_permAln": {
	                        type: "formCheckbox",
	                        label: "A permanent resident alien",
	                        value: "",
	                        length: 1,
	                        required: true,
	                        error: "string",
	                        show: true
	                    }
	                }
	            },
	            "Identification": {
	                title: "Identification",
	                fields: {
	                    "smc_id": {
	                        type: "formText",
	                        label: "SMC Student ID",
	                        name: "smc_id",
	                        value: "",
	                        length: 32,
	                        required: true,
	                        error: "string",
	                        show: true
	                    },
	                    "birthdate": {
	                        type: "formDate",
	                        label: "Birth Date",
	                        name: "birthdate",
	                        value: "",
	                        length: 10,
	                        required: true,
	                        error: "string",
	                        show: true
	                    },
	                    "birthPlace": {
	                    	type: "formLocation",
	                    	label: "Birth Place",
	                    	name: "birthPlace",
	                    	value: "",
	                    	length: 256,
	                    	required: true,
	                    	error: "string",
	                    	show: true
	                    },
	                    "gender": {
	                    	type: "formBoolean",
	                    	label: "Gender",
	                    	name:"gender",	                        
	                        elements: [{label: "Male", value: "1", name: "gender"}, {label: "Female", value: "2", name: "gender"}],
	                        length: 1,
	                        required: true,
	                        error: "string",
	                        show: true
	                    },
	                    "language": {
	                    	type: "formText",
	                    	label: "Native Language",
	                    	name: "language",
	                    	value: "",
	                    	length: 256,
	                    	required: true,
	                    	error: "string",
	                    	show: true
	                    }
	                    
	                }
	            },
	            "Ethnic": {
	                title: "Ethnic Background Information",
	                fields: {
	                	"race_ltno": {
	                    	type: "formBoolean",
	                    	label: "Are you Hispanic/Latino?",
	                    	name:"race_ltno",
	                        elements: [{label: "Yes", value: "1", name: "race_ltno"}, {label: "No", value: "2", name: "race_ltno"}],
	                        length: 1,
	                        required: true,
	                        error: "string",
	                        show: true
	                    },
	                    "race": {
	                    	type: "formCheckboxList",
	                        label: "Regardless of your answer to the prior question, please indicate how you identify yourself. (Check all that apply)",
	                        elements: [{label: "Black or African American", value: "", name: "race_afrAm"}, {label: "Asian", value: "", name: "race_asian"}, {label: "Native Hawaiian or Other Pacific Islander", value: "", name: "race_hwii"}, {label: "American Indian or Alaska Native", value: "", name: "race_amInd"}, {label: "White", value: "", name:"race_whte"}, {label: "Non-Resident Alien", value: "", name: "race_nResAln"}],
	                        name: "race",
	                        value: "",
	                        length: 1,
	                        required: true,
	                        error: "string",
	                        show: true
	                    }	                    
	                }
	            }
	        }
	    },
	    "Page 2" : {
	    	
	    },
	    "Page 3" : {
	    	
	    }
    }
};

Navigation = function ( params, templateFactory ){
	this.render = function (){
		$("body").append(this.order[0].render());
		//return( this.template.render(this) );
	}
	
	this.addPage = function ( params , templateFactory ){
		this.pages[ params.name ] = new Page(params, templateFactory);
		this.order.push( this.pages[ params.name ] );
	}
	
	this.setPage = function ( page ){
		this.currentPage = this.pages[ page ];
		this.render();
	}
	
	this.getTemplate = function(){
		this.template = templateFactory.getTemplate(this.type)
	}
	
	this.pages = new Object();
	this.order = new Array();
	this.currentPage = this.firstPage;
	this.type = "navigation";
	
	this.templateFactory = templateFactory;
	this.getTemplate();
	
	for( page in params.pages ){
		this.addPage(params.pages[page], templateFactory);
	};
};

Page = function ( params, templateFactory ){
	this.addSection = function (section, title){
		this.sections[title] = new Section(section, templateFactory);
	};
	
	this.render = function (){
		for (section in this.sections){
			this.sectionsHtml.push( this.sections[section].render() );
		};
		return( this.template.render(this) );
	};
	
	this.getTemplate = function(){
		this.template = templateFactory.getTemplate(this.type);
	};
	
	this.title = params.title;
	this.sectionsHtml = [];
	this.type = "formPage";
	this.sections = new Object();
	
	_.extend(this, params);
	
	for(section in params.sections){
		this.addSection(params.sections[section], section, templateFactory)
	};
	
	this.templateFactory = templateFactory;
	this.getTemplate();
}

Section = function (params, templateFactory){
	this.render = function (){
		for (field in this.fields){
			this.fieldsHtml.push( this.fields[field].render() )
		}
		return( this.template.render(this) );
	}
	
	this.addField = function (field, title, templateFactory){
		this.fields[title] = new Field(field, templateFactory);
	}
	
	this.getTemplate = function(){
		this.template = templateFactory.getTemplate(this.type)
	}
	
	this.title = params.title;
	this.type = "formSection";
	this.fields = {};
	this.fieldsHtml = [];
	
	_.extend(this, params);
	
	for(field in params.fields){
		this.addField(params.fields[field], field, templateFactory);
	}
	
	this.templateFactory = templateFactory;
	this.getTemplate();
}

Field = function ( params , templateFactory){
	this.render = function (){
		return( this.template.render(this) );
	}
	
	this.setValue = function ( value ){
		
	}
	
	this.getTemplate = function(){
		this.template = templateFactory.getTemplate(this.type)
	}
	
	this.type = "text";
    this.required = false;
    this.error = "This field has an error.";
    this.show = true;
	
	_.extend(this, params);
	
	this.templateFactory = templateFactory;
	this.getTemplate();
};

TemplateFactory = function(TemplateConstructor){
	this.getTemplate = function(type){
		return (this.templates[type]);
	}
	
	templates = new Object();
	
	$('script[type="text/x-handlebars-template"]').each(function(index){
		var datatype = $(this).attr('title');
		var html = $(this).html();
		templates[datatype] = new TemplateConstructor(html);
	})
	
	this.templates = templates;
};

Template = function ( source ) {
	this.source = source;
	this.template = Handlebars.compile(source);
	
	this.render = function (context) {
	    return ( this.template(context) );
	}
};

templateFactory = new TemplateFactory(Template);

navigation = new Navigation(formValues, templateFactory);
navigation.render();
</script>